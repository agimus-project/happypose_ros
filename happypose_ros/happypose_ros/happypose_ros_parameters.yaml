happypose_ros:
  pose_estimator_type: {
    type: string,
    default_value: "cosypose",
    description: "Specyfies which pose estimator to use in the pipeline.",
    validation: {
      one_of<>: [[ "cosypose" ]],
    }
  }
  device: {
    type: string,
    default_value: "cpu",
    description: "Device to which the models will be loaded.",
    validation: {
      one_of<>: [[ "cpu", "cuda:0" ]],
    }
  }
  cosypose:
    object_dataset:
      config_path: {
        type: string,
        default_value: "",
        description: "Path to a folder containing 3D meshes of objects and their renders. The path accespts '$(env MY_ENV)' and 'pacakge://' syntax.",
        validation: {
          size_gt<>: [0],
          "custom_validators::validate_path_folder": null
        }
      }
      label_format: {
        type: string,
        default_value: "",
        description: "Format of the labels used.",
        validation: {
          # TODO add more acceptable label formats
          one_of<>: [[ "ycbv-{label}" ]]
        }
      }
    detector:
      dataset_name: {
        type: string,
        default_value: "",
        description: "Dataset name.",
        validation: {
          one_of<>: [[ "ycbv" ]],
        }
      }
      config_path: {
        type: string,
        default_value: "",
        description: "Path to a folder containing config.yaml and checkpoint.pth.tar files for the detector. The path accespts '$(env MY_ENV)' and 'pacakge://' syntax.",
        validation: {
          size_gt<>: [0],
          "custom_validators::validate_path_folder": null
        }
      }

    pose_estimator:
      renderer:
        n_workers: {
          type: int,
          default_value: 1,
          description: "Number of CPU cores to use during rendering.",
          validation: {
            gt_eq<>: 1,
          }
        }
        preload_cache: {
          type: bool,
          default_value: true,
          # TODO better explenation
          description: "Set if cache has to be preloded.",
        }
        split_objects: {
          type: bool,
          default_value: false,
          # TODO any explenation
          description: "?",
        }
      coarse:
        config_path: {
          type: string,
          default_value: "",
          description: "Path to a folder containing config.yaml and checkpoint.pth.tar for coarse pose estimator. The path accespts '$(env MY_ENV)' and 'pacakge://' syntax.",
          validation: {
            size_gt<>: [0],
            "custom_validators::validate_path_folder": null
          }
        }
      refiner:
        config_path: {
          type: string,
          default_value: "",
          description: "Path to a folder containing config.yaml and checkpoint.pth.tar for refiner pose estimator. The path accespts '$(env MY_ENV)' and 'pacakge://' syntax.",
          validation: {
            size_gt<>: [0],
            "custom_validators::validate_path_folder": null
          }
        }
    inference:
      n_refiner_iterations: {
        type: int,
        default_value: 1,
        description: "Number of iterations for the refiner.",
        validation: {
          gt_eq<>: [ 1 ],
        }
      }
      n_coarse_iterations: {
        type: int,
        default_value: 1,
        description: "Number of iterations for the coarse estimate.",
        validation: {
          gt_eq<>: [ 1] ,
        }
      }
      detection_th: {
        type: double,
        default_value: 0.7,
        description: "Detection threshold of an object used by detector.",
        validation: {
          bounds<>: [0.0, 1.0],
        }
      }
      mask_th: {
        type: double,
        default_value: 0.8,
        # TODO any description
        description: "?",
        validation: {
          bounds<>: [0.0, 1.0],
        }
      }
      labels_to_keep: {
        type: string_array,
        description: "Lables of detected objects to keep.",
        validation: {
          unique<>: null,
        }
      }
  cameras:
    timeout: {
      type: double,
      default_value: 0.0,
      description: "Timeout after which frame from a camera is considered too old. Value '0.0' disables timeout.",
      validation: {
        gt_eq<>: [0.0],
      }
    }
    n_min_cameras: {
      type: int,
      default_value: 1,
      description: "Minimum number of cameras to consider during single view.",
      validation: {
        gt_eq<>: [1],
      }
    }
    names: {
      type: string_array,
      description: "List of names of cameras to subscribe.",
      read_only: true,
      validation: {
        size_gt<>: [0],
        unique<>: null,
      }
    }
    __map_names:
      compressed: {
        type: bool,
        default_value: false,
        description: "Expect compressed messages from given camera.",
      }
      image_topic: {
        type: string,
        default_value: "",
        description: "Topic name to subscribe for images. If empty defaults to '<camera_name>_raw' for not compressed image and '<camera_name>/compressed' for compressed images.",
      }
      info_topic: {
        type: string,
        default_value: "",
        description: "Topic name to subscribe for camera info. If empty defaults to '<camera_name>/info'.",
      }
      k_matrix: {
        type: double_array,
        default_value: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        description: "Camera intrinsic matrix. If not equal to all values of 0.0, orverwrites values from info ROS topic.",
        validation: {
          fixed_size<>: [6],
          lower_element_bounds<>: [0.0]
        }
      }
